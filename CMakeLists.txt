# $Id$
CMAKE_MINIMUM_REQUIRED(VERSION 2.8.6)
IF( COMMAND CMAKE_POLICY )
  CMAKE_POLICY( SET CMP0003 NEW )
ENDIF()

SET(CMAKE_AUTOMOC TRUE)

PROJECT( qedit )
SET( QEDIT_VERSION_MAJOR 2)
SET( QEDIT_VERSION_MINOR 6 )
SET( QEDIT_VERSION_PATCH 4 )
SET( QEDIT_VERSION ${QEDIT_VERSION_MAJOR}.${QEDIT_VERSION_MINOR}.${QEDIT_VERSION_PATCH} )

########### modules #################
SET( CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}/base-cmake" )
INCLUDE( Macros )

########### timestamp #########
GET_BUILD_TIMESTAMP( TIMESTAMP )

########### packages ###############
SET( CPACK_PACKAGE_NAME "qedit" )
SET( CPACK_PACKAGE_VENDOR "hugo.pereira@free.fr" )
SET( CPACK_PACKAGE_VERSION "${QEDIT_VERSION}" )
SET( CPACK_SOURCE_GENERATOR TGZ )
SET( CPACK_SOURCE_PACKAGE_FILE_NAME "${CPACK_PACKAGE_NAME}-${CPACK_PACKAGE_VERSION}" )
INCLUDE( CPack )

########### configuration files ###############
CONFIGURE_FILE( qedit.spec.cmake ${CMAKE_SOURCE_DIR}/qedit.spec )

########### external applications ###############
FIND_PROGRAM( DIFF diff )

########### aspell ###############
FIND_PROGRAM( ASPELL aspell )
FIND_PACKAGE( ASPELL )
ADD_DEFINITIONS( -DWITH_ASPELL=${ASPELL_FOUND} )

########### subdirectories ###############
IF( ENABLE_SHARED )

  SET(CMAKE_INSTALL_RPATH_USE_LINK_PATH TRUE)
  LINK_DIRECTORIES( ${CMAKE_INSTALL_PREFIX}/lib )

ELSE()

  ADD_SUBDIRECTORY( base )
  ADD_SUBDIRECTORY( base-qt )
  ADD_SUBDIRECTORY( base-server )
  ADD_SUBDIRECTORY( base-help )

  IF( ASPELL_FOUND )

    ADD_SUBDIRECTORY( base-spellcheck )

  ENDIF( ASPELL_FOUND )

ENDIF()

ADD_SUBDIRECTORY( document-classes )
ADD_SUBDIRECTORY( filesystem )
ADD_SUBDIRECTORY( src )
